<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Psychophysics in “pure” Python &mdash; Modular Psychophysics 2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="Modular Psychophysics 2.0 documentation" href="index.html" />
    <link rel="next" title="Controlling mPsy experiments from MATLAB" href="tut_matlab.html" />
    <link rel="prev" title="Modular Psychophysics" href="index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>Modular Psychophysics 2.0 documentation</span></a></h1>
        <h2 class="heading"><span>Psychophysics in “pure” Python</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Modular Psychophysics</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="tut_matlab.html">Controlling <cite>mPsy</cite> experiments from MATLAB</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="psychophysics-in-pure-python">
<h1>Psychophysics in &#8220;pure&#8221; Python<a class="headerlink" href="#psychophysics-in-pure-python" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#the-hello-lattice-experiment" id="id1">The &#8220;Hello Lattice!&#8221; experiment</a></li>
<li><a class="reference internal" href="#recording-responses" id="id2">Recording responses</a></li>
<li><a class="reference internal" href="#randomizing-stimulus-parameters" id="id3">Randomizing stimulus parameters</a></li>
<li><a class="reference internal" href="#coding-your-own-stimuli" id="id4">Coding your own Stimuli</a></li>
</ul>
</div>
<div class="section" id="the-hello-lattice-experiment">
<h2><a class="toc-backref" href="#id1">The &#8220;Hello Lattice!&#8221; experiment</a><a class="headerlink" href="#the-hello-lattice-experiment" title="Permalink to this headline">¶</a></h2>
<p>We start with a basic example that will use a lattice stimulus.
Our aim is to run a simple experiment with three trials. In each trial we will show first a fixation dot,
then present a dot lattice and finally collect a response. The code of the full &#8220;Hello lattice!&#8221;
experiment is as follows:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">stimuli</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">fullscreen</span> <span class="o">=</span> <span class="bp">True</span> <span class="c">#False</span>
<span class="n">win</span> <span class="o">=</span> <span class="n">ExpWindow</span><span class="p">(</span><span class="n">fullscreen</span><span class="p">)</span>

<span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">width</span> <span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">win</span><span class="o">.</span><span class="n">height</span> <span class="o">//</span><span class="mi">2</span>

<span class="c"># prepare lattice configuration</span>
<span class="n">p_lattice</span> <span class="o">=</span>  <span class="n">Params</span><span class="p">(</span><span class="n">ap_fs</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">ap_sigma</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">ap_edge</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
                    <span class="n">gamma</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                    <span class="n">dot_size</span><span class="o">=</span><span class="mf">150.0</span><span class="p">,</span> <span class="n">dot_sigma</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">dot_fs</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                    <span class="n">dot_edge</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">dot_c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">dot_phi</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c"># setup presentation screens</span>
<span class="n">stimuli_dots</span> <span class="o">=</span> <span class="p">[</span> <span class="n">DotLattice</span><span class="p">((</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="p">),</span><span class="n">p_lattice</span><span class="p">)</span> <span class="p">]</span>

<span class="n">response_screen</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Pill</span><span class="p">((</span><span class="n">cx</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="n">cy</span><span class="p">),</span><span class="n">Params</span><span class="p">(</span><span class="n">th</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">d</span><span class="o">=</span><span class="mi">3</span><span class="p">)),</span>
                    <span class="n">Pill</span><span class="p">((</span><span class="n">cx</span>    <span class="p">,</span><span class="n">cy</span><span class="p">),</span><span class="n">Params</span><span class="p">(</span><span class="n">th</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">d</span><span class="o">=</span><span class="mi">3</span><span class="p">)),</span>
                    <span class="n">Pill</span><span class="p">((</span><span class="n">cx</span><span class="o">+</span><span class="mi">100</span><span class="p">,</span><span class="n">cy</span><span class="p">),</span><span class="n">Params</span><span class="p">(</span><span class="n">th</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">d</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="p">]</span>

<span class="n">welcome_line</span>  <span class="o">=</span> <span class="p">[</span><span class="n">Text</span><span class="p">((</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="o">-</span><span class="mi">50</span><span class="p">),</span><span class="n">Params</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s">&#39;Press SPACE when ready.&#39;</span><span class="p">))]</span>
<span class="n">farewell_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">Text</span><span class="p">((</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="o">-</span><span class="mi">50</span><span class="p">),</span><span class="n">Params</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s">&#39;Game over!&#39;</span><span class="p">))]</span>
<span class="n">response_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">Text</span><span class="p">((</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="p">),</span><span class="n">Params</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s">&#39;Which was faster</span><span class="se">\n</span><span class="s">Left or Right&#39;</span><span class="p">))]</span>
<span class="n">dot</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dot</span><span class="p">((</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="p">),</span><span class="n">Params</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))]</span>

<span class="c"># setup trials</span>
<span class="n">trials</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">keys_none</span>    <span class="o">=</span> <span class="p">[]</span>
<span class="n">keys_default</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">SPACE</span><span class="p">,</span><span class="n">key</span><span class="o">.</span><span class="n">C</span><span class="p">,</span><span class="n">key</span><span class="o">.</span><span class="n">N</span><span class="p">,</span><span class="n">key</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span><span class="n">key</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]</span>

<span class="c"># add a message screen, wait until button press (duration=0 means wait)</span>
<span class="n">trials</span> <span class="o">+=</span> <span class="p">[</span> <span class="n">Trial</span><span class="p">(</span><span class="s">&#39;Start&#39;</span><span class="p">,</span><span class="n">welcome_line</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">keys_default</span><span class="p">)</span> <span class="p">]</span>
<span class="c"># duration 0 means wait for response</span>

<span class="c"># add three Trials each consisting of a Fixation, Stimulus and a Response screem</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">trials</span> <span class="o">+=</span> <span class="p">[</span><span class="n">Trial</span><span class="p">(</span><span class="s">&#39;Fixation&#39;</span><span class="p">,</span>             <span class="n">dot</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">keys_none</span><span class="p">),</span>
               <span class="n">Trial</span><span class="p">(</span><span class="s">&#39;Lattices&#39;</span><span class="p">,</span>    <span class="n">stimuli_dots</span><span class="p">,</span>  <span class="mi">500</span><span class="p">,</span> <span class="n">keys_none</span><span class="p">),</span>
               <span class="n">Trial</span><span class="p">(</span><span class="s">&#39;Response&#39;</span><span class="p">,</span> <span class="n">response_screen</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="n">keys_none</span><span class="p">,</span> <span class="n">mouse</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span> 

<span class="n">trials</span> <span class="o">+=</span> <span class="p">[</span><span class="n">Trial</span><span class="p">(</span><span class="s">&#39;End&#39;</span><span class="p">,</span><span class="n">farewell_line</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">keys_none</span><span class="p">)]</span>

<span class="c"># tell visionpyg about trials</span>
<span class="n">win</span><span class="o">.</span><span class="n">set_trials</span><span class="p">(</span><span class="n">trials</span><span class="p">)</span>

<span class="c"># run experiment</span>
<span class="c"># visionpyg takes Trials from the begining of the trials list</span>
<span class="c"># if the trials list is eempty visionpyg waits</span>
<span class="c"># ESCAPE stops the experiment at any time</span>
<span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>To run it simply download the file and execute it. If you are new to Python, I suggest you try
creating and running the script from scratch. Create a simple text file, name it &#8220;dots_tut1.py&#8221;,
copy the code from the box above and paste it into your text editor. Save the script and run it.</p>
<p>Now we will walk through the code:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">stimuli</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">fullscreen</span> <span class="o">=</span> <span class="bp">True</span> <span class="c">#False</span>
<span class="n">win</span> <span class="o">=</span> <span class="n">ExpWindow</span><span class="p">(</span><span class="n">fullscreen</span><span class="p">)</span>

<span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">width</span> <span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">win</span><span class="o">.</span><span class="n">height</span> <span class="o">//</span><span class="mi">2</span>
</pre></div>
</td></tr></table></div>
<p>The first few lines initialize the library (line 1), initialize the window (lines 3-4) and
create Python variables <tt class="docutils literal"><span class="pre">cx,</span> <span class="pre">cy</span></tt> that will hold the coordinates of the center of the screen,
which will later be used to position stimuli.</p>
<p>Next we will need to create presentation screens.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># prepare lattice configuration</span>
<span class="n">p_lattice</span> <span class="o">=</span>  <span class="n">Params</span><span class="p">(</span><span class="n">ap_fs</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">ap_sigma</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">ap_edge</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
                    <span class="n">gamma</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                    <span class="n">dot_size</span><span class="o">=</span><span class="mf">150.0</span><span class="p">,</span> <span class="n">dot_sigma</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">dot_fs</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                    <span class="n">dot_edge</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">dot_c</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">dot_phi</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="recording-responses">
<h2><a class="toc-backref" href="#id2">Recording responses</a><a class="headerlink" href="#recording-responses" title="Permalink to this headline">¶</a></h2>
<p>We will build on the previous example. We leave the stimuli intact and add a piece of code
that will enable keeping record of various events in the experiment. Events are generated
by mPsy presentation module or by stimuli. Three types of events are generated by default:</p>
<ul class="simple">
<li>TRIAL event - when a trial starts</li>
<li>KEY event - a key is pressed</li>
<li>MOUSE event - a mouse button is pressed</li>
</ul>
<p>To catch the events we need to create a function that gets called every time an event is triggered:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># create a function that will be triggered by events TRIAL, MOUSE, KEY ...</span>
<span class="n">log</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;dots2.log&#39;</span><span class="p">,</span><span class="s">&#39;wb&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">record_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">trial</span><span class="p">,</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">log</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">trial</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span>
</pre></div>
</td></tr></table></div>
<p>The function and its parameters can have any names, but the number of parameters has to have always the same (four).
The contents of the parameters will be:</p>
<ul>
<li><p class="first">event - text, name of the event</p>
</li>
<li><p class="first">time - numerical value, number of seconds (since when depends on platform)</p>
</li>
<li><p class="first">trial - trial object, this object contains stimuli and its parameters</p>
</li>
<li><dl class="first docutils">
<dt>args - properties of the event, for KEY event the name of the key pressed,</dt>
<dd><p class="first last">for MOUSE event the coordinate and the button clicked</p>
</dd>
</dl>
</li>
</ul>
<p>When you run the resulting file, the file <em>dots2.log</em> will look like this:</p>
<div class="highlight-none"><div class="highlight"><pre>TRIAL 0.575153048996 Start []
KEY 1.31466873576 Start SPACE
TRIAL 1.3156867604 Fixation []
TRIAL 2.33855819112 Lattices []
TRIAL 3.86717378322 Response []
MOUSE 5.86993089944 Response [814, 453, 1]
TRIAL 5.87124100698 Fixation []
TRIAL 6.89199839131 Lattices []
TRIAL 8.42179287708 Response []
MOUSE 9.6018394316 Response [627, 428, 1]
TRIAL 9.60313044609 Fixation []
TRIAL 10.6309067569 Lattices []
TRIAL 12.1618943546 Response []
MOUSE 15.1811783249 Response [814, 456, 1]
TRIAL 15.1816048716 End []
</pre></div>
</div>
<p>Sometimes it might be more useful to keep only the response, this can be done by looking at the content
of the parameters passed to the logging function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">record_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">trial</span><span class="p">,</span><span class="n">args</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s">&#39;MOUSE&#39;</span> <span class="ow">and</span> <span class="n">trial</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;Response&#39;</span><span class="p">:</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">log</span><span class="p">,</span> <span class="s">&#39;RESP&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>A record of such an experiment would the look like this:</p>
<div class="highlight-none"><div class="highlight"><pre>RESP 814 453
RESP 627 428
RESP 814 456
</pre></div>
</div>
<p>Later on we will show how to compute correctness of the response before writing it out.</p>
</div>
<div class="section" id="randomizing-stimulus-parameters">
<h2><a class="toc-backref" href="#id3">Randomizing stimulus parameters</a><a class="headerlink" href="#randomizing-stimulus-parameters" title="Permalink to this headline">¶</a></h2>
<p>Parameters of stimuli in an experiment are usually randomized, shuffled.
To generate a specific number of shuffled parameters we can use Python lists. Specifically,
two operations come in handy, shuffling and concatenation.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&gt;&gt;</span> <span class="n">ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]</span>
<span class="o">&gt;&gt;</span> <span class="n">shuffle</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">ratios</span>
<span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
</pre></div>
</div>
<p>In the snippet above, we have created a list of values. Then we used Python <cite>shuffle</cite> function
to shuffle the list in-place (this means, the original list will be modified).</p>
<p>To create a more complicated set of parameters we can concatenate list by the <cite>+</cite> operator
or make multiple copies of a list with the <cite>*</cite> operator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&gt;&gt;</span> <span class="n">ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.2</span><span class="p">]</span>
<span class="o">&gt;&gt;</span> <span class="n">ratios</span> <span class="o">+</span> <span class="n">ratios</span>
<span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
<span class="o">&gt;&gt;</span> <span class="n">ratios</span><span class="o">*</span><span class="mi">3</span>
<span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>
<span class="o">&gt;&gt;</span> <span class="p">[</span><span class="n">ratios</span><span class="p">,</span><span class="n">ratios</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span>
<span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]]</span>
</pre></div>
</div>
<p>To create three blocks of shuffled trials:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">trials</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.2</span><span class="p">]</span>
    <span class="n">shuffle</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span>
    <span class="n">trials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span>
</pre></div>
</div>
<p>Then</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&gt;&gt;</span> <span class="n">trials</span>
<span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]]</span>
</pre></div>
</div>
<p>The <cite>trials</cite> list of blocks, as any other list, can be shuffled.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">&gt;&gt;</span> <span class="n">trials</span>
<span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="coding-your-own-stimuli">
<h2><a class="toc-backref" href="#id4">Coding your own Stimuli</a><a class="headerlink" href="#coding-your-own-stimuli" title="Permalink to this headline">¶</a></h2>
<p>Modular Psychophysics is modular and each of its stimuli are independent programs.
The stimuli providedtrhough <cite>stimuli.py</cite> module are examples.
Modular Psychophysics requires that stimulus has a function draw() and a field (or member) called <cite>params</cite>,
which is an associative array. Associative array is a fundamental object type that
any language has (MATLAB’s struct, R’s named list etc.).</p>
<p>A minimal Python stimulus definition is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyglet</span> <span class="kn">import</span> <span class="n">text</span>

<span class="k">class</span> <span class="nc">Text</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">Params</span><span class="p">(</span>\<span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">msg</span><span class="p">,</span><span class="n">anchor_x</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span><span class="n">halign</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<p>The example stimlus <cite>Text</cite> is a very simple yet functional example of a text label.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyglet</span> <span class="kn">import</span> <span class="n">text</span>

<span class="k">class</span> <span class="nc">Text</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>\<span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="k">print</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">Params</span><span class="p">(</span>\<span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">msg</span><span class="p">,</span><span class="n">halign</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span><span class="n">anchor_x</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[:</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;packages.zip&#39;</span><span class="p">]</span>

    <span class="kn">from</span> <span class="nn">pyglet.gl</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">pyglet.window</span> <span class="kn">import</span> <span class="n">key</span>
    <span class="kn">from</span> <span class="nn">pyglet</span> <span class="kn">import</span> <span class="n">clock</span><span class="p">,</span> <span class="n">clock</span><span class="p">,</span> <span class="n">font</span><span class="p">,</span> <span class="n">graphics</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">text</span>

    <span class="k">class</span> <span class="nc">Params</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> = </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">)</span>
        <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&#39;Params(</span><span class="si">%s</span><span class="s">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">=</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">),)</span>
        <span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span>

    <span class="n">win</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">Window</span><span class="p">()</span>
    <span class="n">stim</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s">&#39;Welcome to Movable Psychophysics.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
        <span class="n">win</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">glPushMatrix</span><span class="p">()</span>
        <span class="n">glTranslatef</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">stim</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">glPopMatrix</span><span class="p">()</span>

    <span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">update</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mf">60.0</span><span class="p">)</span>
    <span class="n">pyglet</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Modular Psychophysics</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="tut_matlab.html">Controlling <cite>mPsy</cite> experiments from MATLAB</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2014, Peter Jurica, Sergei Gepshtein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b2.
    </div>
  </body>
</html>